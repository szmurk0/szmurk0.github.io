<html>
  <head>
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

      body {
          color: white;
          margin: auto;
          font-family: 'Source Code Pro', monospace;
          overflow: auto;
          background: linear-gradient(315deg, rgba(101,0,94,1) 3%, rgba(60,132,206,1) 38%, rgba(48,238,226,1) 68%, rgba(255,25,25,1) 98%);
          animation: gradient 15s ease infinite;
          background-size: 400% 400%;
          background-attachment: fixed;
      }

      @keyframes gradient {
          0% {
              background-position: 0% 0%;
          }
          50% {
              background-position: 100% 100%;
          }
          100% {
              background-position: 0% 0%;
          }
      }

      .wave {
          background: rgb(255 255 255 / 25%);
          border-radius: 1000% 1000% 0 0;
          position: fixed;
          width: 200%;
          height: 12em;
          animation: wave 10s -3s linear infinite;
          transform: translate3d(0, 0, 0);
          opacity: 0.8;
          bottom: 0;
          left: 0;
          z-index: -1;
      }

      .wave:nth-of-type(2) {
          bottom: -1.25em;
          animation: wave 18s linear reverse infinite;
          opacity: 0.8;
      }

      .wave:nth-of-type(3) {
          bottom: -2.5em;
          animation: wave 20s -1s reverse infinite;
          opacity: 0.9;
      }

      @keyframes wave {
          2% {
              transform: translateX(1);
          }
          25% {
              transform: translateX(-25%);
          }
          50% {
              transform: translateX(-50%);
          }
          75% {
              transform: translateX(-25%);
          }
          100% {
              transform: translateX(1);
          }
      }

      ul {
        list-style: none;
        text-align: center;
      }

      ul li.programming {
        background-color: #145369;
        color: #fff;
      }

      ul li.hobby {
        background-color: #e74c3c;
        color: #fff;
      }

      ul li:hover {
        background-color: #fff;
        color: #145369;
        border-color: #145369;
      }  

      ul {
        padding: -32px;
      }

      ul li {
        display: inline-block;
        margin: 10px;
        float: center;
        font-weight: bold;
        padding: 10px;
        border: 2px solid #ccc;
        border-radius: 10px;
        transition: background-color 0.3s ease;
      }

      ul li:hover {
        background-color: #fff;
        color: #145369;
        border-color: #145369;
      }

      a:hover {
        text-decoration: underline;
      }

      a {
        color: black;
        text-decoration: none;
      }

      p {
        font-size: 1.2em;
        line-height: 1.5;
        margin: 20px;
        text-align: justify;
      }
      .center-text {
          text-align: center;
          margin: 0 auto;
      }


    </style>

    
    
  </head>
  <body>

    <br>
    <br>
    
  <script>
    import * as dotenv from 'dotenv';
    dotenv.config();
    
    import express from 'express';
    import fetch from 'node-fetch';
    
    const port = parseInt(process.env.PORT || '8080', 10);
    const api_keys = JSON.parse(process.env.API_KEYS);
    const upstreamUrl = 'https://api.openai.com/v1/chat/completions';
    
    const corsHeaders = {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'GET, HEAD, POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type, Authorization',
    };
    
    const randomChoice = (arr) => arr[Math.floor(Math.random() * arr.length)];
    
    const obfuscateOpenAIResponse = (text) => text.replace(/\borg-[a-zA-Z0-9]{24}\b/g, 'org-************************').replace(' Please add a payment method to your account to increase your rate limit. Visit https://platform.openai.com/account/billing to add a payment method.', '');
    
    const app = express();
    app.disable('etag');
    app.disable('x-powered-by');
    app.use(express.json());
    
    app.use((err, req, res, next) => {
      if (err instanceof SyntaxError && err.status === 400 && 'body' in err) {
        return res.status(400).set(corsHeaders).type('text/plain').send(err.message);
      }
      next();
    });
    
    const handleOptions = (req, res) => {
      res.setHeader('Access-Control-Max-Age', '1728000').set(corsHeaders).sendStatus(204);
    };
    
    const handlePost = async (req, res) => {
      const contentType = req.headers['content-type'];
      if (!contentType || contentType !== 'application/json') {
        return res.status(415).set(corsHeaders).type('text/plain').send("Unsupported media type. Use 'application/json' content type");
      }
    
      const { stream } = req.body;
      if (stream != null && stream !== true && stream !== false) {
        return res.status(400).set(corsHeaders).type('text/plain').send('Parametr `stream` nie może być wartości boolean');
      }
    
      try {
        const authHeader = req.get('Authorization');
        const authHeaderUpstream = authHeader || `Bearer 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`;
    
        const requestHeader = {
          'Content-Type': 'application/json',
          'Authorization': authHeaderUpstream,
          'User-Agent': 'curl/7.64.1',
        };
        const resUpstream = await fetch(upstreamUrl, {
          method: 'POST',
          headers: requestHeader,
          body: JSON.stringify(req.body),
        });
    
        if (!resUpstream.ok) {
          const { status } = resUpstream;
          const text = await resUpstream.text();
          const textObfuscated = obfuscateOpenAIResponse(text);
          return res.status(status).set(corsHeaders).type('text/plain').send(`OpenAI API odpowiedziało:\n\n${textObfuscated}`);
        }
    
        const contentType = resUpstream.headers.get('content-type');
        if (contentType) {
          res.setHeader('Content-Type', contentType);
        }
        const contentLength = resUpstream.headers.get('content-length');
        if (contentLength) {
          res.setHeader('Content-Length', contentLength);
        }
        if (stream) {
          res.setHeader('Connection', 'keep-alive');
        }
        res.set({
          ...corsHeaders,
          'Cache-Control': 'no-cache',
        });
    
        resUpstream.body.pipe(res);
      } catch (error) {
        res.status(500).set(corsHeaders).type('text/plain').send(error.message);
      }
    };
    
    app.options('/v1/', handleOptions);
    app.post('/v1/', handlePost);
    app.options('/v1/chat/completions', handleOptions);
    app.post('/v1/chat/completions', handlePost);
    
    app.use('*', (req, res) => {
      res.status(404).set(corsHeaders).type('text/plain').send('nie znaleziono');
    });
    
    app.listen(port, () => {
      console.log(`Server listening on port ${port}`);
    });
    
</script>

  <div>
     <div class="wave"></div>
     <div class="wave"></div>
     <div class="wave"></div>
  </div>

  <center><h2> ChatGPT </h2></center>
  <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
   

  </body>
